TextIt=window.TextIt||{},TextIt.ui=function(){function e(){localStorage.wordCount&&"0"!==localStorage.wordCount&&(M=parseInt(localStorage.wordCount),A.value=localStorage.wordCount,E.className="word-counter active",v()),"true"===localStorage.darkLayout&&(document.body.className=!1===j?"yang":"yin",j=!j)}function t(){TextIt.util.supportsHtmlStorage()&&(localStorage.darkLayout=j,localStorage.wordCount=A.value)}function n(){if(q=document.body,h=document.querySelector(".ui"),N=document.querySelector(".color-flip"),N.onclick=r,C=document.querySelector(".fullscreen"),C.onclick=o,I=document.querySelector(".target "),I.onclick=c,B){(L=document.querySelector(".save")).onclick=a;var e=document.querySelectorAll(".saveselection span");for(var t in e)e[t].onclick=m;document.querySelector(".savebutton").onclick=u}else document.querySelector(".save.useicons").style.display="none";(b=document.querySelector(".overlay")).onclick=g,(k=document.querySelector(".content")).onkeyup=p,H=b.querySelector(".wordcount"),(A=H.querySelector("input")).onchange=d,A.onkeyup=i,T=b.querySelector(".description"),saveModal=b.querySelector(".saveoverlay"),E=document.querySelector(".word-counter"),D=E.querySelector(".progress"),(w=document.querySelector(".about")).onclick=l,(x=document.querySelector(".header")).onkeypress=s}function o(e){screenfull.toggle(),screenfull.enabled&&document.addEventListener(screenfull.raw.fullscreenchange,function(){screenfull.isFullscreen?C.innerHTML=_:C.innerHTML=$})}function r(e){document.body.className=!1===j?"yang":"yin",j=!j,t()}function c(e){b.style.display="block",H.style.display="block",A.focus()}function l(e){b.style.display="block",T.style.display="block"}function a(e){b.style.display="block",saveModal.style.display="block"}function u(e){if(void 0!==F&&""!=F){var t=new Blob([W],{type:"text/plain;charset=utf-8"}),n=x.innerHTML.replace(/(\t|\n|\r)/gm,"");""===n&&(n="TextIt"),saveAs(t,n+".txt")}else document.querySelector(".saveoverlay h1").style.color="#FC1E1E"}function s(e){13===e.keyCode&&(e.preventDefault(),k.focus())}function i(e){13===e.keyCode&&(e.preventDefault(),y(parseInt(this.value)),S(),k.focus())}function d(e){y(parseInt(this.value))}function y(e){e>0?(M=e,E.className="word-counter active",v()):(M=0,E.className="word-counter"),t()}function p(e){M>0&&v()}function v(){var e=TextIt.editor.getWordCount()/M;D.style.height=100*e+"%",D.className=e>=1?"progress complete":"progress"}function m(e){document.querySelectorAll("span.activesave").length>0&&(document.querySelector("span.activesave").className=""),document.querySelector(".saveoverlay h1").style.cssText="";var t;if(!e)var e=window.event;e.target?t=e.target:e.srcElement&&(t=e.srcElement),3==t.nodeType&&(t=t.parentNode),t.className="activesave",F=t.getAttribute("data-format");var n=document.querySelector("header.header").innerHTML.replace(/(\r\n|\n|\r)/gm,"")+"\n",o=document.querySelector("article.content").innerHTML;W=f(F,n,o);var r=document.querySelector(".hiddentextbox");r.value=W,r.focus(),r.select()}function f(e,t,n){var o;switch(e){case"html":o=(o=(t="<h1>"+t+"</h1>")+n).replace(/\t/g,"");break;case"markdown":t="#"+(t=(t=t.replace(/\t/g,"")).replace(/\n$/,""))+"#";var r=(o=(o=n.replace(/\t/g,"")).replace(/<b>|<\/b>/g,"**").replace(/\r\n+|\r+|\n+|\t+/gi,"").replace(/<i>|<\/i>/g,"_").replace(/<blockquote>/g,"> ").replace(/<\/blockquote>/g,"").replace(/<p>|<\/p>/gi,"\n").replace(/<br>/g,"\n")).match(/<a href="(.+)">(.+)<\/a>/gi);if(null!==r)for(var c=0;c<r.length;c++){var l=document.createElement("div");l.innerHTML=r[c];var a=(s=l.firstChild).getAttribute("href"),u=s.textContent||s.innerText||"";o=o.replace(r[c],"["+u+"]("+a+")")}o=t+"\n\n"+o;break;case"plain":t=t.replace(/\t/g,"");var s=document.createElement("div");s.innerHTML=n,o=t+(o=(o=s.textContent||s.innerText||"").replace(/\t/g,"").replace(/\n{3}/g,"\n").replace(/\n/,""))}return o}function g(e){"overlay"===e.target.className&&S()}function S(){b.style.display="none",H.style.display="none",T.style.display="none",saveModal.style.display="none",document.querySelectorAll("span.activesave").length>0&&(document.querySelector("span.activesave").className=""),F=""}var q,k,h,b,w,T,x,C,N,I,L,M,H,A,E,D,B,F,W,$="&#xe000;",_="&#xe004;",j=!1;return{init:function(){B=!!new Blob,n(),wordCountActive=!1,TextIt.util.supportsHtmlStorage()&&e(),console.log("That's work :D")}}}();